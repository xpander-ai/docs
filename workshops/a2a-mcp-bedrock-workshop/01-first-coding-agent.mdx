---
title: "Build Your First Coding Agent"
description: "Set up a local coding agent with MCP compliance and understand its core capabilities"
icon: "code"
---

In this module, you'll build your first autonomous coding agent using xpander.ai's framework. This agent will be able to understand and manipulate code, helping you automate development tasks.

ğŸš€ In this module, you'll set up a complete AI coding assistant powered by xpander.ai and Amazon Bedrock. You'll create a local development environment, configure your agent with custom instructions, test it with repository management tasks, and connect it to the cloud for remote access. By the end, you'll have a powerful AI coding partner that can clone repositories, read and write code, and help automate your development workflow!

## ğŸ”§ Setup Your Development Environment

Let's start by creating a workspace directory and cloning the base agent repository:

```bash
mkdir workshop 
cd workshop/
git clone https://github.com/xpander-ai/coding-agent.git
mv coding-agent dev-agent-1
cd dev-agent-1
```

Open the project in Cursor IDE:

```bash
cursor .
```

## ğŸ› ï¸ Configure Your Local Environment

<Note>
  This workshop requires Python 3.12.7 or newer. To check your current version, run:
  
  ```bash
  python3 --version
  ```
  
  If you need to upgrade, use the following methods:
  - **macOS**: `brew uninstall python  --ignore-dependencies && brew install python3 && python3 --version` 
  - **Windows**: Download the latest installer from [python.org](https://www.python.org/downloads/)
</Note>

Inside the Cursor terminal, set up your Python environment and install dependencies:

```bash
python3 -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt
npm install -g xpander-cli
```

## ğŸ”‘ Authenticate to xpander.ai
```bash
xpander login
```

This command will open the xpander.ai platform and ask you to login or register. Once confirmed, you will be redirected back to the terminal, which will display the following:
```bash
Hi David, Welcome to xpander!

Your organization id: {id-}
Your personal API Key is: {id-}

I've created default profile configured in ~/.xpander
```

Create a `.env` file in the root directory with the following credentials:

```
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_SESSION_TOKEN=your_aws_session_token  # if using temporary credentials
AWS_PROFILE=your_profile # if using AWS Profile without keys
AWS_REGION=us-west-2
XPANDER_API_KEY=your_xpander_api_key ## From the output above
```

<Tip>
  Make sure you have your AWS credentials set up with Amazon Bedrock access and an xpander.ai API key ready for this step.
  If you are running this workshop in person, ask the xpander.ai team to provide you access.
</Tip>

## ğŸ¤– Create Your Agent

Now let's use the xpander CLI to create a new agent:

```bash
xpander agent new
```

Complete the agent creation wizard:

```bash
âœ¨ Create New Agent
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
? Enter a name for your new agent: dev-agent-1
â ‹ Creating agent "dev-agent-1"...Creating agent in organization: 
âœ” Agent created successfully
? Would you like to personalize your agent now? No ##
â ‹ Deploying agent...Deploying agent in organization: 
âœ” Agent deployed successfully

âœ… Agent created and ready to use!
? Would you like to locally initialize your agent now? Yes


âœ¨ Initializing agent
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â„¹ Agent dev-agent-1 retrieved successfully
? The current directory is not empty. Proceeding will override 'requirements.txt' and add or update xpander-related files (xpander_config.json, agent_instructions.json, 
etc). Yes
âœ” Agent initialized successfully
? Would you like to deploy your agent now? No
```

<Tip>
  If you skipped the init command, you can always run `xpander agent init` and select the agent you just created.
</Tip>


## âœï¸ Customize Agent Instructions

Next, open `agent_instructions.json` ask Cursor to help you create effective agent instructions:

```
Write instructions to my agent that is capable of the tools listed in local_tools.py and carefully validate the code before committing it.
```

Here's an example of what your instructions might look like:

```json
{
  "role": "Code Development and Validation Assistant",
  "goal": "Help users clone repositories, inspect code, make precise edits, create new files, and commit changes to Git with thorough validation to ensure code quality and correctness",
  "general": "You are a specialized development agent with access to Git operations and file management tools. Follow these guidelines when assisting users:\n\n1. Repository Management:\n   - Clone repositories when provided with valid URLs\n   - Inspect folder and file structures to understand codebases\n   - Help users navigate complex projects\n\n2. Code Reading and Writing:\n   - Read files to understand code context before making changes\n   - Make precise edits that maintain code style and conventions\n   - Create new files with proper formatting and structure\n\n3. Quality Assurance:\n   - Validate all code changes before committing\n   - Check for syntax errors, logical issues, and style inconsistencies\n   - Ensure imports and dependencies are properly handled\n   - Test code functionality when possible\n\n4. Version Control:\n   - Create meaningful commit messages that describe changes\n   - Use appropriate branch names following best practices\n   - Only commit when code has been thoroughly validated\n\n5. Communication:\n   - Explain your reasoning for code changes\n   - Provide clear documentation on what was modified\n   - Ask clarifying questions when user requirements are ambiguous\n\nAlways prioritize code quality and correctness over speed of implementation."
}
```

## ğŸš€ Run Your Agent Locally

Now it's time to test your agent:

```bash
python main.py
```

<Note>
  Pay attention that the agent is limited to running inside the sandbox folder. To see files generated by the agent, navigate to the `sandboxes` folder and look for the thread ID from the terminal output.
</Note>

## ğŸ’¬ Example Agent Interaction

Here's what you might see in the terminal as your agent runs:

```bash
â¯ python main.py
Sandbox base directory: /Users/david/Developer/workshop/dev-agent-1/sandboxes
loading agent 9002f816-1926-4556-a275-6e6fcc8bb86a
ğŸ§  Adding task to a new thread
ğŸª„ Starting Agent Loop
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 1
running tool git_clone on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: git_clone with generated payload: {'repo_url': 'https://github.com/xpander-ai/coding-agent'}
âœ… git_clone
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 2
running tool describe_folders_and_files on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: describe_folders_and_files with generated payload: {}
âœ… describe_folders_and_files
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 3
running tool read_file on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: read_file with generated payload: {'file_path': 'coding-agent/README.md'}
âœ… read_file
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 4
running tool read_file on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: read_file with generated payload: {'file_path': 'coding-agent/coding_agent.py'}
âœ… read_file
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 5
running tool read_file on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: read_file with generated payload: {'file_path': 'coding-agent/main.py'}
âœ… read_file
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 6
running tool read_file on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: read_file with generated payload: {'file_path': 'coding-agent/local_tools.py'}
âœ… read_file
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 7
running tool new_file on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
ğŸ”¦ Executing local tool: new_file with generated payload: {'file_path': 'coding-agent-intro.md', 'content': '# ğŸ¤– Autonomous Coding Agent\n\n## Introduction\n\nI am an autonomous Coding Agent built with the xpander-ai/coding-agent framework. As a self-driven software engineer, I can generate, execute, and manage code through structured function-calling and a smart agent loop. I operate independently to help you build, test, and deploy software with minimal human intervention.\n\n## Modular Architecture\n\nMy architecture is designed with modularity at its core:\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Any other     â”‚         â”‚ coding_agent â”œâ”€Nativeâ”€â–ºâ”‚  Any LLM provider  â”‚\nâ”‚ Agent         â”œâ”€--A2Aâ”€â”€â–ºâ”‚              â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                 â”‚\n                                 â”‚ functionâ€‘calls (MCP)\n                                 â–¼\n                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                          â”‚  xpander.ai connectors  â”‚â”€â”€â”€â–¶ Any Rest API\n                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                                 â”‚\n                                 â–¼\n                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                          â”‚  Secure sandbox (FS)    â”‚\n                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Key Components:\n\n1. **LLM-Agnostic Core**: I can work with any LLM provider (OpenAI, Anthropic, Bedrock, etc.) without modification.\n2. **Secure Sandbox**: All file operations occur in an isolated environment to prevent security risks.\n3. **Function-Call Interface**: I interact with systems through a standardized function-calling mechanism.\n4. **Agent-to-Agent Communication**: I can collaborate with other specialized agents in a coordinated workflow.\n\n## Schema-Driven Actions\n\nI operate using well-defined schemas for all actions:\n\n- **Tool Declarations**: Each function I can call is precisely defined with parameter types and requirements\n- **Model Context Protocol (MCP)**: I follow standardized protocols for interacting with external systems\n- **Validation Layers**: All inputs and outputs are validated against schemas to ensure correctness\n\nThis schema-driven approach ensures that my actions are predictable, secure, and compatible with various systems.\n\n## Multi-Step Planning\n\nI break down complex tasks into manageable steps:\n\n1. **Task Analysis**: I analyze the requirements to determine necessary actions\n2. **Dependency Mapping**: I identify dependencies between subtasks\n3. **Sequential Execution**: I execute steps in the optimal order\n4. **Error Handling**: I detect failures and adapt my approach accordingly\n\nThis planning capability allows me to tackle complex software engineering tasks that require multiple coordinated actions.\n\n## Context-Aware Memory\n\nMy memory system maintains state across interactions:\n\n- **Thread-Based Memory**: Each conversation maintains its own persistent state\n- **Contextual Awareness**: I remember previous actions and their outcomes\n- **File System Awareness**: I track changes to the codebase over time\n- **Execution History**: I maintain a record of all tool calls and their results\n\nThis memory system enables me to work on long-running tasks and maintain context across multiple interactions.\n\n## Connector-Based System Integration\n\nI integrate with external systems through a flexible connector architecture:\n\n- **Git Operations**: Clone repositories, commit changes, and push to branches\n- **File System Operations**: Create, read, update, and delete files securely\n- **API Integrations**: Connect to any REST or gRPC endpoint\n- **Testing Frameworks**: Execute and interpret test results\n\nThese connectors allow me to interact with real-world systems while maintaining security and reliability.\n\n## The Agent Loop: Reliable, Auditable, Deterministic Automation\n\nAt the heart of my operation is the agent loop, which enables reliable, auditable, and deterministic automation:\n\n1. **Input Processing**: I receive and interpret user instructions\n2. **Planning**: I determine the sequence of actions needed\n3. **Tool Selection**: I choose the appropriate tools for each step\n4. **Execution**: I call functions with validated parameters\n5. **Result Analysis**: I interpret the results of each action\n6. **Adaptation**: I adjust my approach based on outcomes\n7. **Communication**: I provide clear updates on progress and results\n\nThis structured loop ensures that my actions are:\n\n- **Reliable**: I follow consistent patterns and handle errors gracefully\n- **Auditable**: Every action is logged and can be reviewed\n- **Deterministic**: Given the same inputs, I produce consistent outputs\n\nBy combining these capabilities, I can autonomously handle complex software engineering tasks while maintaining the high standards expected in professional development environments.'}
âœ… new_file
ğŸ§  Thread id: 81b08c86-ca55-4b3e-a14d-af690f07846e
--------------------------------------------------------------------------------
ğŸ” Step 8
running tool xpfinish-agent-execution-finished on agent 9002f816-1926-4556-a275-6e6fcc8bb86a with execution 1da0e645-068b-4fdf-8d71-762a5c880241
âœ… xpfinish-agent-execution-finished
ğŸ“ Last message: {'toolResult': {'toolUseId': 'tooluse_20vLMJVATIOaHWVJmx477Q', 'content': [{'text': '"I\'ve successfully cloned the xpander-ai/coding-agent repository and created a comprehensive introduction file called \'coding-agent-intro.md\'. This file introduces the Autonomous Coding Agent as a self-driven software engineer capable of generating, executing, and managing code through structured function-calling and a smart agent loop.\\n\\nThe introduction covers:\\n\\n1. The agent\'s modular architecture that works with any LLM provider\\n2. Schema-driven actions that ensure predictable and secure operations\\n3. Multi-step planning capabilities for complex tasks\\n4. Context-aware memory system that maintains state across interactions\\n5. Connector-based system integration for working with external systems\\n6. The agent loop that enables reliable, auditable, and deterministic automation\\n\\nThe file is ready for review in the repository. As requested, I did not commit any changes."'}]}}
```

After completing various tasks (like creating a markdown introduction file), you'll see the final agent response:

```
ğŸ§  AI Agent response: I've successfully cloned the xpander-ai/coding-agent repository and created a comprehensive introduction file called 'coding-agent-intro.md'. This file introduces the Autonomous Coding Agent as a self-driven software engineer capable of generating, executing, and managing code through structured function-calling and a smart agent loop.

The introduction covers:

1. The agent's modular architecture that works with any LLM provider
2. Schema-driven actions that ensure predictable and secure operations
3. Multi-step planning capabilities for complex tasks
4. Context-aware memory system that maintains state across interactions
5. Connector-based system integration for working with external systems
6. The agent loop that enables reliable, auditable, and deterministic automation

The file is ready for review in the repository. As requested, I did not commit any changes.
```

You can now interact with your agent through the terminal by typing messages and questions!

## ğŸŒ Stream Events from the Cloud to Your Local Agent

Now let's set up your agent to receive events from the xpander.ai cloud platform. This allows you to interact with your agent through the web UI while processing happens on your local machine.

Start the event handler to listen for cloud events:

```bash
python xpander_handler.py
```

1. Navigate to the URL displayed in the terminal output (e.g., `https://app.xpander.ai/agents/your-agent-id`)
2. You'll see your agent in the xpander.ai web interface
3. Try sending a message like "Hi" to your agent
4. Watch as the request is processed by your local machine and the response appears in the web UI

Did you notice that it returned "Your execution result"? That's a static response configured in the xpander_handler.py file.

Now, let's modify the handler to return the real agent response by updating the on_execution_request function:

```python
# Initialize agent instance
coding_agent = CodingAgent(agent=agent)

def on_execution_request(execution_task: AgentExecution) -> AgentExecutionResult:
    agent.init_task(execution=execution_task.model_dump())
    execution_status = coding_agent._agent_loop()
    
    return AgentExecutionResult(
        result=execution_status.result,
        is_success=True if execution_status.status == ExecutionStatus.COMPLETED else False,
    )
```

After making this change, you will see the following result:

<Frame>![](/images/screenshots/2025-04-29-10-09-32.png)</Frame>

This setup creates a powerful hybrid system where your agent can be accessed through the cloud interface while all the processing happens securely on your local machine.

## ğŸš€ Deploy to the Cloud

Deploy the agent to the cloud:

```bash
xpander deploy
```

## ğŸ”‘ Configure Cloud Environment Variables

Congratulations on deploying your agent to the cloud! While the deployment is in progress, let's configure the necessary environment variables in the xpander vault to ensure your agent can run properly in the cloud environment.

1. Navigate to the xpander.ai platform and sign in
2. Go to settings > Environment Secrets
3. Add the following keys with their respective values:

```
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_SESSION_TOKEN=your_aws_session_token  # if using temporary credentials
```

These credentials will allow your cloud-deployed agent to access Amazon Bedrock services securely without storing sensitive information in your code.

<Tip>
  Configuring these environment variables in the vault is crucial for cloud deployment. Your local .env file is not uploaded to the cloud for security reasons, so these values must be configured separately in the xpander platform.
</Tip>

Once deployment is complete and environment variables are configured, your agent will be fully operational in the cloud, allowing others to interact with it through the web interface.

<Tip>
  run `xpander logs` to stream logs from the remote server to your terminal
</Tip>

## ğŸ”„ Next Steps

Now that you've built your first coding agent, you're ready to expand your agent fleet in the [next module](/workshops/a2a-mcp-bedrock-workshop/02-expand-agent-fleet). 