---
title: "Building a Hello World Agent"
description: "Quick guide to programmatically build and run your first xpander.ai agent"
icon: "rocket"
---

![](/static/images/screenshots/tutorial-hello-world.png)

## Overview

This guide shows you how to create and run a simple agent using the xpander.ai SDK. The SDK provides a powerful foundation for building AI agents that can think, act, and scale across any stack with zero lock-in.

<Info>
The xpander.ai UI provides a visual interface for creating agent graphs and visualizing tool relationships, while the SDK gives you direct programmatic control for custom integrations.
</Info>

## Step 1: Environment Setup

Let's set up your development environment and create your first agent.

### Install Dependencies

Create a new project directory and install the required packages:

```bash
mkdir hello-agent
cd hello-agent
pip install xpander-sdk openai python-dotenv
```

### Configure API Keys

Create a `.env` file with your API keys:

```bash
XPANDER_API_KEY=your_xpander_api_key
OPENAI_API_KEY=your_openai_api_key
```

<Tip>
Get your Xpander API key from [app.xpander.ai](https://app.xpander.ai) under Settings ‚Üí API Keys.
</Tip>

### Create Your First Agent

Create a file named `hello_agent.py` with this streamlined implementation:

```python
from xpander_sdk import XpanderClient, LLMProvider
from openai import OpenAI
import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# Initialize clients
xpander = XpanderClient(api_key=os.environ['XPANDER_API_KEY'])
openai = OpenAI(api_key=os.environ['OPENAI_API_KEY'])

# Create or get agent
def get_or_create_agent():
    """Get existing agent or create a new one"""
    agent_id = os.environ.get('XPANDER_AGENT_ID')
    
    if agent_id:
        print(f"üìå Loading existing agent: {agent_id}")
        return xpander.agents.get(agent_id=agent_id)
    else:
        print("üéâ Creating new agent...")
        agent = xpander.agents.create(
            name="Hello World Agent",
            instructions={"goal": "Answer questions helpfully and accurately."}
        )
        print(f"‚úÖ Created agent: {agent.id}")
        print(f"üí° Add to .env: XPANDER_AGENT_ID={agent.id}")
        return agent

# Main execution
def main():
    # Get or create agent
    agent = get_or_create_agent()
    
    # Add a task
    agent.add_task(input="Hello! What can you do?")
    
    # Run agent loop
    while not agent.is_finished():
        # Get LLM response
        response = openai.chat.completions.create(
            model="gpt-4o-mini",
            messages=agent.messages,
            tools=agent.get_tools(llm_provider=LLMProvider.OPEN_AI),
            temperature=0
        )
        
        # Add response to agent
        agent.add_messages(response.model_dump())
        
        # Extract and run any tool calls
        tool_calls = agent.extract_tool_calls(
            llm_response=response.model_dump()
        )
        
        if tool_calls:
            agent.run_tools(tool_calls=tool_calls)
    
    # Get result
    result = agent.retrieve_execution_result()
    print(f"\nü§ñ Agent: {result.result}")
    print(f"üîó View in UI: https://app.xpander.ai/agents/{agent.id}")

if __name__ == "__main__":
    main()
```

<Note>
The code above automatically handles both creating a new agent and reusing an existing one. After the first run, add the agent ID to your `.env` file to reuse the same agent.
</Note>

### Run Your Agent

```bash
python hello_agent.py
```

You should see output like:
```
üéâ Creating new agent...
‚úÖ Created agent: abc123...
üí° Add to .env: XPANDER_AGENT_ID=abc123...

ü§ñ Agent: I'm an AI assistant created to help answer questions accurately and helpfully. I can assist with a wide range of topics including...
üîó View in UI: https://app.xpander.ai/agents/abc123...
```

## Step 2: Add Thread Management

Now let's enhance our agent to handle multi-turn conversations. We'll add thread management capabilities.

### Changes to Implement

Add the following function to your existing code:

```python
# Function to chat with the agent
def chat(agent: Agent, message, thread_id=None, local_tools_by_name=None):
    """Send a message to the agent and get a response"""
    print(f"\nüë§ User: {message}")
    
    # Add task to agent (using thread_id for conversation continuity)
    agent.add_task(input=message, thread_id=thread_id)
    
    # Run the agent loop
    agent_loop(agent, local_tools_by_name)
    
    # Get and return result
    result = agent.retrieve_execution_result()
    print(f"ü§ñ Agent: {result.result}")
    print(f"üßµ Thread ID: {result.memory_thread_id}")
    return result.memory_thread_id
```

Replace the main execution code with:

```python
# Have a multi-turn conversation
thread_id = chat(agent, "What is machine learning?")
chat(agent, "Give me an example of a machine learning algorithm.", thread_id)
```

<Info>
Thread IDs allow you to maintain context across multiple messages. The agent remembers the conversation history, creating a more natural dialogue experience.
</Info>

## Step 3: Add Local Tools

Let's add the ability to run local Python functions as tools.

### New Local Tool Definition

Add this code at the top of your file, after the imports:

```python
# Define local function
def get_current_time(timezone=None):
    """Get the current date and time with millisecond precision."""
    now = datetime.now()
    return f"Current time{' in '+timezone if timezone else ''}: {now}"

# Set up local tools
local_tools = [
    {
        "declaration": {
            "type": "function",
            "function": {
                "name": "get_current_time",
                "description": "Get the precise current date and time.",
                "parameters": {
                    "type": "object",
                    "properties": {
                        "timezone": {
                            "type": "string",
                            "description": "Timezone (e.g., 'UTC', 'EST')"
                        }
                    },
                    "required": []
                }
            }
        },
        "fn": get_current_time
    }
]

local_tools_list = [tool['declaration'] for tool in local_tools]
local_tools_by_name = {tool['declaration']['function']['name']: tool['fn'] 
                      for tool in local_tools}
```

### Updates to Agent Loop

Add local tool execution to the `agent_loop` function:

```python
# Inside agent_loop, after running cloud tools:
# Run local tools if provided
if local_tools_by_name:
    pending_local_tool_execution = agent.retrieve_pending_local_tool_calls(tool_calls=tool_calls)
    local_tools_results = []
    
    for tc in pending_local_tool_execution:
        print(f"üõ†Ô∏è Running local tool: {tc.name}")
        tool_call_result = ToolCallResult(function_name=tc.name, tool_call_id=tc.tool_call_id, payload=tc.payload)
        try:
            if tc.name in local_tools_by_name:
                tool_call_result.is_success = True
                tool_call_result.result = local_tools_by_name[tc.name](**tc.payload)
            else:
                raise Exception(f"Local tool {tc.name} not found")
        except Exception as e:
            tool_call_result.is_success = False
            tool_call_result.is_error = True
            tool_call_result.result = str(e)
        finally:
            local_tools_results.append(tool_call_result)

    if local_tools_results:
        print(f"üìù Registering {len(local_tools_results)} local tool results...")
        agent.memory.add_tool_call_results(tool_call_results=local_tools_results)
```

### Register Local Tools

Add this before running the agent:

```python
# Add local tools to the agent
agent.add_local_tools(local_tools_list)
print("üß∞ Local tools added to agent")
```

<CardGroup cols={2}>
  <Card title="Local Tools" icon="screwdriver-wrench">
    Tools that run directly in your Python code, allowing access to local resources and functionality.
  </Card>
  <Card title="Cloud Tools" icon="cloud">
    Tools that run on the Xpander platform, providing access to services like search or external APIs.
  </Card>
</CardGroup>

## Step 4: Add Search Capability

Let's add web search capability using Tavily, which allows your agent to find current information.

### Enable Tavily Search

Add this simplified function to enable search:

```python
from xpander_sdk import AgentGraphItemType, GraphItem

def add_search_capability(agent):
    """Add Tavily search to the agent"""
    # Check if already available
    tools = agent.get_tools(llm_provider=LLMProvider.OPEN_AI)
    if any('tavily' in str(tool).lower() for tool in tools):
        print("‚úÖ Search already enabled")
        return True
    
    try:
        # Get available interfaces
        interfaces = agent.retrieve_agentic_interfaces()
        xpander_interface = next(
            (i for i in interfaces if "xpander" in i.name.lower()), 
            None
        )
        
        if not xpander_interface:
            print("‚ö†Ô∏è  xpander interface not found")
            return False
        
        # Get Tavily operation
        operations = agent.retrieve_agentic_operations(xpander_interface)
        tavily_op = next(
            (op for op in operations if "tavily" in op.name.lower()), 
            None
        )
        
        if tavily_op:
            # Attach to agent
            agent.attach_operations(operations=[tavily_op])
            
            # Add to graph
            agent.graph.add_node(
                GraphItem(
                    agent=agent,
                    item_id=tavily_op.id_to_use_on_graph,
                    name=tavily_op.name,
                    type=AgentGraphItemType.TOOL,
                    is_local_tool=False
                )
            )
            agent.sync()
            
            print("‚úÖ Search capability added")
            return True
            
    except Exception as e:
        print(f"‚ö†Ô∏è  Could not add search: {e}")
    
    return False
```

### Testing Search

Update your main execution code:

```python
# Add Tavily search capability
add_tavily_search(agent)

# Add local tools to the agent
agent.add_local_tools(local_tools_list)
print("üß∞ Local tools added to agent")

print("\nüîç Testing agent with time function and search capability...")
# First message - asking about time
thread_id = chat(agent, "What time is it right now? Use the get_current_time tool.", 
                local_tools_by_name=local_tools_by_name)

# Second message in same thread - asking about search
chat(agent, "What are the latest developments in AI?", thread_id, 
    local_tools_by_name=local_tools_by_name)
```

<Accordion title="How Tavily Search Works">
  Tavily is a search tool that allows your agent to find information on the internet. When your agent needs to answer a question about current events or information that might be online, it can use this tool to search the web and provide up-to-date responses.
</Accordion>

## Key Concepts

### Agent State Management
The SDK provides a simple `is_finished()` method that handles all state management complexity:
- Tracks task completion
- Manages conversation flow
- Handles tool execution states

### Tool Types
<CardGroup cols={2}>
  <Card title="Local Tools" icon="laptop">
    Functions that run in your Python environment with access to local resources
  </Card>
  <Card title="Cloud Tools" icon="cloud">
    Services that run on Xpander platform for scalability and managed access
  </Card>
</CardGroup>

### Best Practices

1. **Environment Variables**: Always use `.env` files for API keys and agent IDs
2. **Error Handling**: Wrap tool executions in try-catch blocks
3. **Thread Management**: Use thread IDs to maintain conversation context
4. **Tool Registration**: Register tools before starting conversations
5. **State Monitoring**: Use the UI to visualize agent execution

## What You've Learned

You now know how to:

‚úÖ Create and reuse agents programmatically  
‚úÖ Build conversation flows with thread management  
‚úÖ Add local tools for custom functionality  
‚úÖ Enable web search capabilities  
‚úÖ Handle agent state with the simple `is_finished()` pattern

<Tip>
The Xpander SDK follows a "Deploy AI Agents that think, act, and scale" philosophy - your agents can run anywhere with zero lock-in.
</Tip>

## Complete Example

Here's the full code combining all features:

```python
from xpander_sdk import XpanderClient, LLMProvider, ToolCallResult, AgentGraphItemType, GraphItem
from openai import OpenAI
from datetime import datetime
import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# Initialize clients  
xpander = XpanderClient(api_key=os.environ['XPANDER_API_KEY'])
openai = OpenAI(api_key=os.environ['OPENAI_API_KEY'])

# Local tool function
def get_current_time(timezone=None):
    """Get the current date and time."""
    return f"Current time: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}"

# Tool declaration
local_tools = [
    {
        "type": "function",
        "function": {
            "name": "get_current_time",
            "description": "Get the current date and time",
            "parameters": {
                "type": "object",
                "properties": {
                    "timezone": {
                        "type": "string",
                        "description": "Timezone name"
                    }
                },
                "required": []
            }
        }
    }
]

local_tools_map = {"get_current_time": get_current_time}

# Agent execution with local tools
def run_agent(agent, local_tools_map=None):
    """Execute the agent loop with local tool support"""
    while not agent.is_finished():
        response = openai.chat.completions.create(
            model="gpt-4o-mini",
            messages=agent.messages,
            tools=agent.get_tools(llm_provider=LLMProvider.OPEN_AI),
            temperature=0
        )
        
        agent.add_messages(response.model_dump())
        
        tool_calls = agent.extract_tool_calls(
            llm_response=response.model_dump()
        )
        
        if tool_calls:
            # Run cloud tools
            agent.run_tools(tool_calls=tool_calls)
            
            # Run local tools
            if local_tools_map:
                pending_local = agent.retrieve_pending_local_tool_calls(tool_calls)
                results = []
                
                for call in pending_local:
                    print(f"üîß Running local tool: {call.name}")
                    
                    result = ToolCallResult(
                        function_name=call.name,
                        tool_call_id=call.tool_call_id,
                        payload=call.payload
                    )
                    
                    try:
                        if call.name in local_tools_map:
                            output = local_tools_map[call.name](**call.payload)
                            result.result = output
                            result.is_success = True
                        else:
                            result.result = f"Tool {call.name} not found"
                            result.is_error = True
                    except Exception as e:
                        result.result = str(e)
                        result.is_error = True
                    
                    results.append(result)
                
                if results:
                    agent.memory.add_tool_call_results(tool_call_results=results)

# Chat function with thread support
def chat(agent, message, thread_id=None):
    """Send a message and get a response"""
    print(f"\nüë§ You: {message}")
    agent.add_task(input=message, thread_id=thread_id)
    run_agent(agent, local_tools_map)
    result = agent.retrieve_execution_result()
    print(f"ü§ñ Agent: {result.result}")
    return result.memory_thread_id

# Add search capability
def add_search_capability(agent):
    """Add Tavily search to the agent"""
    tools = agent.get_tools(llm_provider=LLMProvider.OPEN_AI)
    if any('tavily' in str(tool).lower() for tool in tools):
        print("‚úÖ Search already enabled")
        return True
    
    try:
        interfaces = agent.retrieve_agentic_interfaces()
        xpander_interface = next(
            (i for i in interfaces if "xpander" in i.name.lower()), None
        )
        
        if xpander_interface:
            operations = agent.retrieve_agentic_operations(xpander_interface)
            tavily_op = next(
                (op for op in operations if "tavily" in op.name.lower()), None
            )
            
            if tavily_op:
                agent.attach_operations(operations=[tavily_op])
                agent.graph.add_node(
                    GraphItem(
                        agent=agent,
                        item_id=tavily_op.id_to_use_on_graph,
                        name=tavily_op.name,
                        type=AgentGraphItemType.TOOL,
                        is_local_tool=False
                    )
                )
                agent.sync()
                print("‚úÖ Search capability added")
                return True
                
    except Exception as e:
        print(f"‚ö†Ô∏è  Could not add search: {e}")
    
    return False

# Main function
def main():
    # Get or create agent
    agent_id = os.environ.get('XPANDER_AGENT_ID')
    if agent_id:
        agent = xpander.agents.get(agent_id=agent_id)
        print(f"üìå Using existing agent: {agent_id}")
    else:
        agent = xpander.agents.create(
            name="Hello World Agent",
            instructions={"goal": "Be helpful and use tools when appropriate."}
        )
        print(f"‚úÖ Created agent: {agent.id}")
        print(f"üí° Add to .env: XPANDER_AGENT_ID={agent.id}")
    
    # Add capabilities
    agent.add_local_tools(local_tools)
    add_search_capability(agent)
    
    # Have a conversation
    thread_id = chat(agent, "What time is it?")
    thread_id = chat(agent, "What's the latest news in AI?", thread_id)
    chat(agent, "Thanks for the help!", thread_id)
    
    print(f"\nüîó View in UI: https://app.xpander.ai/agents/{agent.id}")

if __name__ == "__main__":
    main()
```

### Run the Complete Example

Save as `hello_world_agent.py` and run:

```bash
python hello_world_agent.py
```

### Expected Output

```
‚úÖ Created agent: abc-123-def-456
üí° Add to .env: XPANDER_AGENT_ID=abc-123-def-456
üß† Local tools registered
‚úÖ Search capability added

üë§ You: What time is it?
üîß Running local tool: get_current_time
ü§ñ Agent: The current time is 2024-12-15 14:32:18.

üë§ You: What's the latest news in AI?
ü§ñ Agent: Here are some of the latest developments in AI...

üë§ You: Thanks for the help!
ü§ñ Agent: You're welcome! Feel free to ask if you need anything else.

üîó View in UI: https://app.xpander.ai/agents/abc-123-def-456
```

## Next Steps

<CardGroup cols={2}>
  <Card title="Explore the UI" icon="browser" href="https://app.xpander.ai">
    Create visual agent graphs and monitor execution
  </Card>
  <Card title="SDK Reference" icon="code" href="/docs/sdk-reference">
    Deep dive into all SDK capabilities
  </Card>
  <Card title="Build Custom Tools" icon="wrench" href="/tutorials/build-custom-tool">
    Create powerful custom tools for your agents
  </Card>
  <Card title="Deploy to Production" icon="rocket" href="/docs/deployment">
    Scale your agents to production
  </Card>
</CardGroup>

<Note>
Join our [Discord community](https://discord.gg/xpander) to share your agents and get help!
</Note>